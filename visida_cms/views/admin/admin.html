<div class="container" ng-controller="adminController">
	<!-- <h3>Roles</h3>
	<div>
		<ul>
			<li ng-repeat="role in roles">{{ role.role }}</li>
		</ul>
		<div class="{{ (roleLoading) && 'loader' || '' }}"></div>
		<small class="text-danger">{{ roleError }}</small><br/>
		<span style="font-weight: bold;">Add Role: </span>
		<input type="text" ng-model="newRole" placeholder="role name"/> <button ng-click="addRole()">Add</button>
	</div>
	<br/> -->
	<br/>
	<h3>Users</h3>
	<div>
		<table>
			<tr>
				<th>Username</th>
				<th>Role</th>
				<th><!--Households--></th>
			</tr>
			<tr ng-repeat="user in users">
				<td>{{ user.userName }}</td>
				<td>
					<form ng-submit="assignRole(user.id, selectedRole)">
						<select ng-model="selectedRole" ng-init="selectedRole = user.role">
							<option ng-repeat="uRole in roles">{{ uRole.role }}</option>
						</select>
						<input type="submit" style="margin-left: .3em;" value="Set">
					</form>
				</td>
				<!-- <td>
					<form ng-submit="assignHousehold(user.id, selectedHousehold)">
						<select ng-model="selectedHousehold">
							<option ng-repeat="household in config.households" value="{{household}}">{{ household }}</option>
						</select>
						<input type="submit" style="margin-left: .3em;" value="Assign">
					</form>
					<ul style="margin-top: 10px;">
						<li ng-repeat="household in user.assignedHouseholds">{{ household.guid }}
							<span role="button" class="glyphicon glyphicon-remove" style="padding-left: 1.2em;" ng-click="unassignHousehold(user.id, household.guid)"></span>
						</li>
					</ul>
				</td> -->
				<td>
					<button ng-click="deleteUser(user.id)"><span class="glyphicon glyphicon-remove"/> Delete User</button>
				</td>
			</tr>
		</table>
		<div class="{{ (userLoading) && 'loader' || '' }}"></div>
		<small class="text-danger">{{ userError }}</small>
		<br/>
		<h5>New User</h5>
		<form ng-submit="createUser(newUserUsername, newUserPassword, newUserRole)">
			<table>
				<tr>
					<td><label for="newUsername">Username: </label></td>
					<td><input id="newUsername" type="text" name="newUsername" placeholder="jsmith" ng-model="newUserUsername"></td>
				</tr>
				<tr>
					<td><label for="newPassword">Password: </label></td>
					<td><input id="newPassword" type="password" name="newPassword" ng-model="newUserPassword"></td>
				</tr>
				<tr>
					<td><label for="role">Role: </label></td>
					<td><select name="role" ng-model="newUserRole"><option ng-repeat="role in roles">{{ role.role }}</option></select></td>
				</tr>
			</table>
			<div class="{{ (newUserLoading ) && 'loader' || '' }}"></div>
			<small class="text-danger">{{ newUserError }}</small>
			<input type="submit" style="margin-left: .5em;" value="Create User">
		</form><br/>
		
	</div>
	<br/>
	<span class="h3 left">Studies</span><button class="btn btn-primary left btn-sm" style="margin-left: 50px;" ng-click="createStudy()">Create New</button>
	<small class="text-danger">{{ studyError }}</small>
	<div class="{{ (userLoading) && 'loader' || '' }}"></div>
	<div class="row" ng-repeat="study in studies" style="margin: 10px;">
		<span class="h4">{{ study.name }}</span><br/>
		<div style="margin-top: 12px; margin-bottom: 12px; vertical-align: middle; border-bottom: 2px solid #2f80b7;" class="col-sm-12">
			<span style="float: left; margin-right: 24px;" class="h4 left">Food Composition Table: </span>
			<form ng-submit="updateStudyTable(study, tableid)" class="form-inline left" style="float: left;">
				<select ng-model="tableid" ng-init="tableid = study.foodCompositionTable.id.toString()" class="form-control">
					<option ng-repeat="t in fctables" value="{{t.id}}">{{ t.name }}</option>
				</select>
				<input type="submit" style="margin-left: .3em;" value="Set" class="btn btn-primary btn-sm">
			</form>
		</div>
		<div class="col-sm-12 col-md-4">
			<span class="h4">Households</span>
			<div ng-repeat="household in study.households" style="padding: 6px;">
				<span style="font-weight: bolder; color: grey;">{{ household.guid }}</span>
			</div>
		</div>
		<div class="col-sm-12 col-md-4">
			<span class="h4">Analysts</span>
			<div ng-repeat="analyst in study.analysts" style="padding: 6px;">
				<span style="font-weight: bolder; color: grey;">{{ analyst.userName }}</span>
				<span class="glyphicon glyphicon-remove" role="button" ng-click="unassignStudyAnalyst(study, analyst.id)"></span>
			</div>
			<form ng-submit="assignStudyAnalyst(study, analystid)" class="form-inline left">
				<select class="form-control" ng-model="analystid" ><option ng-repeat="user in users" value="{{user.id}}">{{user.userName}}</option></select>
				<input type="submit" value="Assign" class="btn btn-primary btn-sm"  style="margin-left: .3em;">
			</form>
		</div>
	</div>
	<br/>
	<h3>Progress</h3>
	<div class="row" ng-repeat="household in households" style="margin: 10px;">
		<div class="col-sm-12 col-md-5">
			<span class="h4">{{ household.guid }}</span><br/>
		</div>
		<div class="col-sm-12 col-md-7">
			<ul style="list-style-type: none;">
				<li ng-repeat="work in household.workDone" style="font-size: larger;"><span>{{ work.userName }} - </span><span style="margin-left: 20px;">{{ work.items }} food items created - </span><span>last logged in at <span style="font-style: italic;">{{ work.lastOnline | date : 'h:mma dd/MM/yyyy' }}</span></span></li>
			</ul>
		</div>
		<div class="row" style="margin: 10px;">
			<span>Identification: </span>
			<div class="progress" style="width: 100%;">
				<div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:{{ 100 * (household.identifyCompleted / household.recordTotal) }}%">
			    	Completed
				</div>
				<div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:{{ 100 * (household.identifyInProgress / household.recordTotal) }}%">
			    	In Progress
				</div>
				<div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:{{ 100 * (household.recordNotStarted / household.recordTotal) }}%">
			    	Not Started
				</div>
			</div>
			<span>Quantification: </span>
			<div class="progress" style="width: 100%;">
				<div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:{{ 100 * (household.portionCompleted / household.recordTotal) }}%">
			    	Completed
				</div>
				<div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:{{ 100 * (household.portionInProgress / household.recordTotal) }}%">
			    	In Progress
				</div>
				<div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:{{ 100 * (household.recordNotStarted / household.recordTotal) }}%">
			    	Not Started
				</div>
			</div>
		</div>
	</div>
</div>